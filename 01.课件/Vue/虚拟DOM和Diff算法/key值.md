# key值相关

1. key值的使用
   1. 在项目中,遍历数据产生多个节点的时候,需要给每个节点都添加上唯一的key值
      1. 语法:v-for
2. 常用作key值的数据
   1. 遍历得到数据身上的唯一标识,例如:id,vid等
   2. 遍历得到的下标,例如:index
   3. 遍历得到的数据本身,例如:item
3. key值的作用
   1. 与diff算法有关,可以优化性能
   2. diff算法做的事情:当遍历的数据发生变化的时候,Vue会创建新的虚拟DOM树,并与旧的虚拟DOM树进行比较,找到可以复用的真实DOM节点(key值就是比较的关键)
   3. first render(首次渲染)
      1. 根据当前组件的template内容,编译生成render函数
      2. 调用render函数,传入当前最新数据,得到当前的虚拟DOM
      3. 根据当前的虚拟DOM,创建对应的真实DOM
      4. 将得到的真实DOM,替换掉页面上的指定区域#app
      5. 最终,GUI线程根据当前最新的html内容,渲染页面
      6. 注意:diff算法是用来比较两个虚拟DOM的差异的,首次渲染中,没有上一次的虚拟DOM,没得比较
   4. update render(更新渲染)
      1. 再次调用render函数,传入当前最新数据,得到最新的虚拟DOM
      2. 对比新旧两个虚拟DOM,找出可以复用的真实DOM
      3. 比较过程中,如果发现某个虚拟DOM没有可以复用的真实DOM,就创建一个全新的真实DOM
      4. 将真实DOM树,替换掉页面上指定的区域
      5. 最终,GUI线程根据当前最新的html内容,渲染页面
      6. 注意:在以上流程中,流程2和3就是所谓的diff算法
4. 使用下标作为key值可能会出现的问题?
   1. 使用下标作为key值,并不是一定会出问题的
      1. 因为首次渲染中,是没有diff算法参与的,那么key值就没有任何作用
   2. input案例
      1. diff算法生效了,他有去复用真实DOM,但是该案例中复用错了节点,导致页面效果不对
   3. 商品排序案例
      1. diff算法生效了,他没有成功复用节点,该案例中明明可以完美复用之前所有的节点,但是最终结果是根本不复用,全部创建全新的
5. 使用唯一标识作为key值的好处
   1. 只要服务器的数据与他唯一标识的关系没有发生变化,那么前端的节点就可以一直复用下去