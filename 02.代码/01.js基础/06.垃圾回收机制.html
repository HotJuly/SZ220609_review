<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /*
            垃圾回收机制
                找到一些没有人引用的对象,并将其使用的内存进行释放
                最终将内存腾出,用于存储其余新的数据

                注意:如果是基本数据类型,只会出现内存覆盖,不存在内存回收
                    至于对象属性中的基本数据类型,只会随着对象一起销毁

            垃圾回收机制回收内存的方法:
                1.早期版本:引用计数法
                    每个对象在出生的时候,身上都会有一个看不见的属性count,初始值为0
                        count的用处:用于记录该对象被多少个地方引用着
                        每有一个人引用该对象,他的count数值就会+1
                        每有一个人取消引用该对象,他的count数值就会-1
                        如果某个对象的count属性值为0,那么说明当前对象无人使用,就需要回收释放内存

                    缺点:如果出现多个对象互相引用对方,那么即便将存着这些对象的变量都清空,这些对象的count也不会变为0,
                        最终导致,开发者从代码中已经找不到这些对象了,但是他们还活着,占用内存

                2.最新版本:Scavenger算法
                    该算法一共划分出了两片区域分别是,新生代区和老生代区
                    新生代区(试用期还没过)
                        新生代区专门存储新创建的对象(存在时间比较短的对象)
                        新生代区中一共具有from和to两个数组
                            from数组用于存储上一次存活的对象
                            to数组用于存储现在还存活的对象

                        准备工作:js引擎会从window对象开始逐层扫描内部所有的对象,
                            并将扫描到的对象,都记录在form数组中

                        流程:
                            1.js引擎会再次从window对象开始逐层扫描所有的对象(递归扫描)
                            2.如果发现扫描到的对象存在于from数组中,就将其调到to数组中
                                让他从from数组中消失
                            3.当扫描结束之后,from数组中还剩余的对象,就是需要回收,无人使用的对象
                                js引擎会将from数组中的对象都进行释放
                            4.将to数组变为from数组,from数组变为to数组
                        
                        扩展:只要在to数组中出现过三次的对象,就会被移到老生代区去

                        算法:以空间换时间

                    老生代区(正式合同签完)
                        老生代区专门存储创建时间相对较久的对象(老而不死)
                        老生代区只有一个数组

                        流程:
                            1.在js引擎扫描window对象的时候,如果遇到了老生代区中的对象
                                会给该对象打上标记,证明这个对象还有人使用
                            2.当扫描结束之后,需要遍历该数组,找到没有标记的对象,
                                这些对象就是需要回收的对象
                            3.回收完无用对象之后,需要再次遍历当前老生代区数组,将内部的内存结构进行紧凑化处理
                                将碎片内存都移到最后,方便下次存储数据使用

                        算法:以时间换空间
                
        */
      //    var num = 1;
      //    num = 2;

      //--------------------------
      //    var obj = {
      //     name:"xiaoming"
      //    }

      //    var obj2 = obj;

      //    obj = null;

      //-------------------------------

      //   var obj = {};

      //   var obj2 = {};

      //   obj.obj2 = obj2;
      //   obj2.obj = obj;

      //   obj.obj2=null;
      //   obj2.obj=null;

      //   obj = null;
      //   obj2 = null;

      //-------------------------------------
      var obj = {
        a: {
          d: {
            e: {},
            f: {},
          },
        },
        b: {
          g: {},
        },
        c: {},
      };

      setTimeout(()=>{
        obj.a.d=null;
      },2000)
    </script>
  </body>
</html>
